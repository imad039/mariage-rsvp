<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Confirmation de pr√©sence ‚Äî Mariage</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Roboto:wght@400;500&display=swap');
body {margin:0;font-family:'Roboto',sans-serif;background:linear-gradient(135deg,#f5f0e6,#e0d7c6);display:flex;justify-content:center;align-items:center;min-height:100vh;}
.container {background:white;border-radius:20px;padding:40px;width:100%;max-width:450px;box-shadow:0 10px 30px rgba(0,0,0,0.15);text-align:center;}
h1 {font-family:'Playfair Display',serif;font-size:28px;margin-bottom:10px;color:#5a4633;}
p {color:#6b5e50;font-size:14px;margin-bottom:20px;}
input, select, button {width:100%;padding:10px;margin-top:8px;margin-bottom:15px;border-radius:10px;border:1px solid #d1c4b2;font-size:14px;box-sizing:border-box;}
input:focus, select:focus {outline:none;border-color:#b9975b;box-shadow:0 0 5px #b9975b;}
button {background:#b9975b;color:white;font-weight:500;cursor:pointer;border:none;transition:0.3s;}
button:hover {background:#9e7f44;}
.message {margin-top:15px;font-weight:bold;color:green;}
.error {color:red;margin-bottom:10px;}
.hidden {display:none;}
table {width:100%;border-collapse:collapse;margin-top:20px;}
th,td {padding:10px;border:1px solid #d1c4b2;text-align:center;}
th {background:#b9975b;color:white;}
</style>
</head>
<body>
<div class="container" id="main-container">
    <h1>Confirmation de pr√©sence</h1>
    <p>Entrez votre code √† 6 chiffres pour confirmer votre pr√©sence.</p>

    <div id="form-step1">
        <input type="text" id="code" placeholder="Ex: 123456" maxlength="6">
        <button onclick="checkCode()">Valider le code</button>
        <div id="error" class="error"></div>
    </div>

    <div id="form-step2" class="hidden">
        <p id="welcome"></p>
        <label>Je serai :</label>
        <select id="status">
            <option value="">-- Choisir --</option>
            <option value="present">Pr√©sent(e)</option>
            <option value="absent">Non pr√©sent(e)</option>
        </select>
        <label>Nombre d'accompagnants :</label>
        <select id="plusOnes"></select>
        <button onclick="submitRsvp()">Envoyer ma r√©ponse</button>
    </div>

    <div id="thankyou" class="hidden">
        <h2>Merci pour votre r√©ponse üíï</h2>
    </div>
</div>

<script>
const GUESTS_DB = {
    "123456": { name: "Imad Sabagh", allowedGuests: 1 },
    "654321": { name: "Lea Martin", allowedGuests: 2 },
    "111111": { name: "Famille Dubois", allowedGuests: 4 }
    // Ajoutez/modifiez les codes ici
};

const SECRET_CODE = "999999"; // Code sp√©cial pour la page secr√®te

function checkCode(){
    const code = document.getElementById('code').value.trim();
    const errorDiv = document.getElementById('error');
    errorDiv.textContent = '';

    if(!/^\d{6}$/.test(code)){
        errorDiv.textContent = "Le code doit contenir exactement 6 chiffres.";
        return;
    }

    if(code === SECRET_CODE){
        showSecretPage();
        return;
    }

    const guest = GUESTS_DB[code];
    if(!guest){
        errorDiv.textContent = "Code introuvable. V√©rifiez le code ou contactez les mari√©s.";
        return;
    }

    document.getElementById('welcome').textContent = `Bonjour ${guest.name} üëã`;
    const plusOnesSelect = document.getElementById('plusOnes');
    plusOnesSelect.innerHTML = '';
    for(let i=0;i<=guest.allowedGuests;i++){
        let opt = document.createElement('option');
        opt.value = i;
        opt.text = i;
        plusOnesSelect.appendChild(opt);
    }

    document.getElementById('form-step1').classList.add('hidden');
    document.getElementById('form-step2').classList.remove('hidden');
    document.getElementById('form-step2').dataset.code = code;
}

function submitRsvp(){
    const status = document.getElementById('status').value;
    const plusOnes = document.getElementById('plusOnes').value;
    const code = document.getElementById('form-step2').dataset.code;
    const guest = GUESTS_DB[code];

    if(!status){
        alert("Veuillez indiquer si vous serez pr√©sent(e) ou non.");
        return;
    }

    let submissions = JSON.parse(localStorage.getItem('rsvp_submissions') || '[]');
    submissions = submissions.filter(s => s.code !== code);
    submissions.push({ code, name: guest.name, status, plusOnes, when: new Date().toISOString() });
    localStorage.setItem('rsvp_submissions', JSON.stringify(submissions));

    document.getElementById('form-step2').classList.add('hidden');
    document.getElementById('thankyou').classList.remove('hidden');
}

function showSecretPage(){
    const submissions = JSON.parse(localStorage.getItem('rsvp_submissions') || '[]');
    document.body.innerHTML = `
        <div style="padding:30px;font-family:sans-serif;background:linear-gradient(135deg,#f5f0e6,#e0d7c6);min-height:100vh;">
            <h1 style="color:#5a4633;">Page Secr√®te ‚Äî Liste des RSVP</h1>
            <table>
                <tr><th>Code</th><th>Nom</th><th>Status</th><th>Accompagnants</th><th>Date</th></tr>
                ${submissions.map(r=>`
                    <tr>
                        <td>${r.code}</td>
                        <td>${r.name}</td>
                        <td>${r.status}</td>
                        <td>${r.plusOnes}</td>
                        <td>${new Date(r.when).toLocaleString()}</td>
                    </tr>
                `).join('')}
            </table>
            <button onclick="location.reload()" style="margin-top:20px;padding:10px 20px;background:#b9975b;color:white;border:none;border-radius:10px;cursor:pointer;">Retour</button>
        </div>
    `;
}
</script>
</body>
</html>


